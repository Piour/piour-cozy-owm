{"version":3,"file":"public/javascripts/app.js","sources":["app/collections/city_collection.coffee","app/initialize.coffee","app/lib/app_helpers.coffee","app/lib/view.coffee","app/lib/view_collection.coffee","app/models/city.coffee","app/routers/app_router.coffee","app/views/app_view.coffee","app/views/cities_view.coffee","app/views/city_view.coffee","app/views/templates/city.jade","app/views/templates/home.jade","app/views/templates/widget.jade","app/views/widget_view.coffee"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApCA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhDA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3IA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3HA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7BA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzDA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/HA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtDA;;A","sourcesContent":["var City, CityCollection,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nCity = require('../models/city');\n\nmodule.exports = CityCollection = (function(_super) {\n\n  __extends(CityCollection, _super);\n\n  CityCollection.prototype.model = City;\n\n  CityCollection.prototype.url = 'cities';\n\n  function CityCollection(view) {\n    this.view = view;\n    CityCollection.__super__.constructor.call(this);\n    this.bind(\"add\", this.view.renderOne);\n    this.bind(\"reset\", this.view.renderAll);\n  }\n\n  return CityCollection;\n\n})(Backbone.Collection);\n","var _ref, _ref1, _ref2, _ref3, _ref4;\n\nif ((_ref = this.PiourCozyOWM) == null) {\n  this.PiourCozyOWM = {};\n}\n\nif ((_ref1 = PiourCozyOWM.Routers) == null) {\n  PiourCozyOWM.Routers = {};\n}\n\nif ((_ref2 = PiourCozyOWM.Views) == null) {\n  PiourCozyOWM.Views = {};\n}\n\nif ((_ref3 = PiourCozyOWM.Models) == null) {\n  PiourCozyOWM.Models = {};\n}\n\nif ((_ref4 = PiourCozyOWM.Collections) == null) {\n  PiourCozyOWM.Collections = {};\n}\n\n$(function() {\n  var AppView;\n  require('../lib/app_helpers');\n  if (window.location.href.match(\"widget.html\")) {\n    PiourCozyOWM.Views.appView = new (AppView = require('views/widget_view'));\n    PiourCozyOWM.Views.appView.render();\n  } else {\n    PiourCozyOWM.Views.appView = new (AppView = require('views/app_view'));\n    PiourCozyOWM.Views.appView.render();\n  }\n  return Backbone.history.start({\n    pushState: true\n  });\n});\n","\n(function() {\n  return (function() {\n    var console, dummy, method, methods, _results;\n    console = window.console = window.console || {};\n    method = void 0;\n    dummy = function() {};\n    methods = 'assert,count,debug,dir,dirxml,error,exception,\\\n                   group,groupCollapsed,groupEnd,info,log,markTimeline,\\\n                   profile,profileEnd,time,timeEnd,trace,warn'.split(',');\n    _results = [];\n    while (method = methods.pop()) {\n      _results.push(console[method] = console[method] || dummy);\n    }\n    return _results;\n  })();\n})();\n","var View,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = View = (function(_super) {\n\n  __extends(View, _super);\n\n  function View() {\n    return View.__super__.constructor.apply(this, arguments);\n  }\n\n  View.prototype.tagName = 'section';\n\n  View.prototype.template = function() {};\n\n  View.prototype.initialize = function() {\n    return this.render();\n  };\n\n  View.prototype.getRenderData = function() {\n    var _ref;\n    return {\n      model: (_ref = this.model) != null ? _ref.toJSON() : void 0\n    };\n  };\n\n  View.prototype.render = function() {\n    this.beforeRender();\n    this.$el.html(this.template());\n    this.afterRender();\n    return this;\n  };\n\n  View.prototype.beforeRender = function() {};\n\n  View.prototype.afterRender = function() {};\n\n  View.prototype.destroy = function() {\n    this.undelegateEvents();\n    this.$el.removeData().unbind();\n    this.remove();\n    return Backbone.View.prototype.remove.call(this);\n  };\n\n  return View;\n\n})(Backbone.View);\n","var View, ViewCollection, methods,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nView = require('./view');\n\nViewCollection = (function(_super) {\n\n  __extends(ViewCollection, _super);\n\n  function ViewCollection() {\n    this.renderAll = __bind(this.renderAll, this);\n\n    this.renderOne = __bind(this.renderOne, this);\n    return ViewCollection.__super__.constructor.apply(this, arguments);\n  }\n\n  ViewCollection.prototype.collection = new Backbone.Collection();\n\n  ViewCollection.prototype.view = new View();\n\n  ViewCollection.prototype.views = [];\n\n  ViewCollection.prototype.length = function() {\n    return this.views.length;\n  };\n\n  ViewCollection.prototype.add = function(views, options) {\n    var view, _i, _len;\n    if (options == null) {\n      options = {};\n    }\n    views = _.isArray(views) ? views.slice() : [views];\n    for (_i = 0, _len = views.length; _i < _len; _i++) {\n      view = views[_i];\n      if (!this.get(view.cid)) {\n        this.views.push(view);\n        if (!options.silent) {\n          this.trigger('add', view, this);\n        }\n      }\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.get = function(cid) {\n    return this.find(function(view) {\n      return view.cid === cid;\n    }) || null;\n  };\n\n  ViewCollection.prototype.remove = function(views, options) {\n    var view, _i, _len;\n    if (options == null) {\n      options = {};\n    }\n    views = _.isArray(views) ? views.slice() : [views];\n    for (_i = 0, _len = views.length; _i < _len; _i++) {\n      view = views[_i];\n      this.destroy(view);\n      if (!options.silent) {\n        this.trigger('remove', view, this);\n      }\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.destroy = function(view, options) {\n    var _views;\n    if (view == null) {\n      view = this;\n    }\n    if (options == null) {\n      options = {};\n    }\n    _views = this.filter(_view)(function() {\n      return view.cid !== _view.cid;\n    });\n    this.views = _views;\n    view.undelegateEvents();\n    view.$el.removeData().unbind();\n    view.remove();\n    Backbone.View.prototype.remove.call(view);\n    if (!options.silent) {\n      this.trigger('remove', view, this);\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.reset = function(views, options) {\n    var view, _i, _j, _len, _len1, _ref;\n    if (options == null) {\n      options = {};\n    }\n    views = _.isArray(views) ? views.slice() : [views];\n    _ref = this.views;\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      view = _ref[_i];\n      this.destroy(view, options);\n    }\n    if (views.length !== 0) {\n      for (_j = 0, _len1 = views.length; _j < _len1; _j++) {\n        view = views[_j];\n        this.add(view, options);\n      }\n      if (!options.silent) {\n        this.trigger('reset', view, this);\n      }\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.renderOne = function(model) {\n    var view;\n    view = new this.view(model);\n    this.$el.prepend(view.render().el);\n    this.add(view);\n    return this;\n  };\n\n  ViewCollection.prototype.renderAll = function() {\n    this.collection.each(this.renderOne);\n    return this;\n  };\n\n  return ViewCollection;\n\n})(View);\n\nmethods = ['forEach', 'each', 'map', 'reduce', 'reduceRight', 'find', 'detect', 'filter', 'select', 'reject', 'every', 'all', 'some', 'any', 'include', 'contains', 'invoke', 'max', 'min', 'sortBy', 'sortedIndex', 'toArray', 'size', 'first', 'initial', 'rest', 'last', 'without', 'indexOf', 'shuffle', 'lastIndexOf', 'isEmpty', 'groupBy'];\n\n_.each(methods, function(method) {\n  return ViewCollection.prototype[method] = function() {\n    return _[method].apply(_, [this.views].concat(_.toArray(arguments)));\n  };\n});\n\nmodule.exports = ViewCollection;\n","var City,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = City = (function(_super) {\n\n  __extends(City, _super);\n\n  function City() {\n    this.fmtCityDaysForecastInfos = __bind(this.fmtCityDaysForecastInfos, this);\n\n    this.fmtCityForecastInfos = __bind(this.fmtCityForecastInfos, this);\n\n    this.fmtCityWeatherInfos = __bind(this.fmtCityWeatherInfos, this);\n    return City.__super__.constructor.apply(this, arguments);\n  }\n\n  City.prototype.urlRoot = 'cities';\n\n  City.prototype.initialize = function() {\n    this.fmtCityWeatherInfos();\n    this.fmtCityForecastInfos();\n    return this.fmtCityDaysForecastInfos();\n  };\n\n  City.prototype.toRoundCelcius = function(value) {\n    return parseInt(value - 273.15);\n  };\n\n  City.prototype.fmtCityWeatherInfos = function() {\n    var clouds, main, main_weather, name, sys, toSet, weather;\n    toSet = {};\n    weather = this.get(\"weather\");\n    if (weather) {\n      main = weather.main;\n      if (main) {\n        toSet.temp = this.toRoundCelcius(main.temp);\n        toSet.humidity = main.humidity;\n      }\n      main_weather = weather.weather;\n      if (main_weather) {\n        toSet.weather = main_weather[0];\n      }\n      clouds = weather.clouds;\n      if (clouds) {\n        toSet.clouds = clouds.all;\n      }\n      sys = weather.sys;\n      if (sys) {\n        toSet.country = sys.country;\n      }\n      name = weather.name;\n      if (name) {\n        toSet.name = name;\n      }\n    }\n    return this.set(toSet);\n  };\n\n  City.prototype.toReadableHour = function(value) {\n    return value.split(\" \")[1].slice(0, 5);\n  };\n\n  City.prototype.toReadableDate = function(value) {\n    var date;\n    date = new Date(0);\n    date.setUTCSeconds(value);\n    return \"\" + date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear();\n  };\n\n  City.prototype.fmtCityForecastInfos = function() {\n    var forecast, hour, next5, nextHour, now, _i, _len;\n    next5 = [];\n    forecast = this.get(\"hours\");\n    if (forecast) {\n      forecast = forecast.list;\n      now = new Date().getTime();\n      if (forecast) {\n        for (_i = 0, _len = forecast.length; _i < _len; _i++) {\n          hour = forecast[_i];\n          if (hour.dt * 1000 >= now) {\n            nextHour = {};\n            nextHour.hour = this.toReadableHour(hour.dt_txt);\n            nextHour.temp = this.toRoundCelcius(hour.main.temp);\n            nextHour.humidity = hour.main.humidity;\n            nextHour.weather = hour.weather[0];\n            next5.push(nextHour);\n          }\n          if (next5.length >= 5) {\n            break;\n          }\n        }\n      }\n    }\n    return this.set(\"hours\", next5);\n  };\n\n  City.prototype.fmtCityDaysForecastInfos = function() {\n    var day, forecast, next5, nextDay, _i, _len;\n    next5 = [];\n    forecast = this.get(\"days\");\n    if (forecast) {\n      forecast = forecast.list;\n      if (forecast) {\n        for (_i = 0, _len = forecast.length; _i < _len; _i++) {\n          day = forecast[_i];\n          nextDay = {};\n          nextDay.date = this.toReadableDate(day.dt);\n          nextDay.day = this.toRoundCelcius(day.temp.day);\n          nextDay.night = this.toRoundCelcius(day.temp.night);\n          nextDay.humidity = day.humidity;\n          nextDay.weather = day.weather[0];\n          next5.push(nextDay);\n        }\n      }\n    }\n    return this.set(\"days\", next5);\n  };\n\n  return City;\n\n})(Backbone.Model);\n","var AppRouter,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = AppRouter = (function(_super) {\n\n  __extends(AppRouter, _super);\n\n  function AppRouter() {\n    return AppRouter.__super__.constructor.apply(this, arguments);\n  }\n\n  AppRouter.prototype.routes = {\n    '': function() {}\n  };\n\n  return AppRouter;\n\n})(Backbone.Router);\n","var AppRouter, AppView, CitiesView, City, View,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nView = require(\"../lib/view\");\n\nAppRouter = require(\"../routers/app_router\");\n\nCitiesView = require(\"./cities_view\");\n\nCity = require(\"../models/city\");\n\nmodule.exports = AppView = (function(_super) {\n\n  __extends(AppView, _super);\n\n  function AppView() {\n    return AppView.__super__.constructor.apply(this, arguments);\n  }\n\n  AppView.prototype.el = \"body.application\";\n\n  AppView.prototype.template = function() {\n    return require(\"./templates/home\");\n  };\n\n  AppView.prototype.initialize = function() {\n    return this.router = PiourCozyOWM.Routers.AppRouter = new AppRouter();\n  };\n\n  AppView.prototype.afterRender = function() {\n    var _this = this;\n    this.citiesView = new CitiesView();\n    return this.citiesView.collection.fetch({\n      error: function() {\n        return alertUser(\"impossible to retrieve weather informations\");\n      }\n    });\n  };\n\n  AppView.prototype.events = {\n    \"submit #search\": \"cityFind\"\n  };\n\n  AppView.prototype.cityFind = function(evt) {\n    var city, cityObj,\n      _this = this;\n    city = this.$el.find(\"input.city\");\n    cityObj = {\n      \"name\": city.val()\n    };\n    this.citiesView.collection.create(cityObj, {\n      error: function() {\n        return alertUser(\"impossible to add weather informations for \" + city.val());\n      }\n    });\n    return false;\n  };\n\n  return AppView;\n\n})(View);\n","var CitiesView, CityCollection, CityView, ViewCollection,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nViewCollection = require('../lib/view_collection');\n\nCityView = require('./city_view');\n\nCityCollection = require('../collections/city_collection');\n\nmodule.exports = CitiesView = (function(_super) {\n\n  __extends(CitiesView, _super);\n\n  function CitiesView() {\n    return CitiesView.__super__.constructor.apply(this, arguments);\n  }\n\n  CitiesView.prototype.el = \"#cities\";\n\n  CitiesView.prototype.view = CityView;\n\n  CitiesView.prototype.initialize = function() {\n    return this.collection = new CityCollection(this);\n  };\n\n  return CitiesView;\n\n})(ViewCollection);\n","var CityView, View,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nView = require(\"../lib/view\");\n\nmodule.exports = CityView = (function(_super) {\n\n  __extends(CityView, _super);\n\n  CityView.prototype.className = \"city\";\n\n  CityView.prototype.tagName = \"li\";\n\n  CityView.prototype.events = {\n    \"click .remove\": \"deleteCity\"\n  };\n\n  function CityView(model) {\n    this.model = model;\n    CityView.__super__.constructor.call(this);\n  }\n\n  CityView.prototype.initialize = function() {\n    return this.model.on(\"change\", (function(t, evt) {\n      var _ref;\n      if ((_ref = this.model.attributes.weather) != null ? _ref.icon : void 0) {\n        return this.render.call(this);\n      } else if (this.model.attributes.weather != null) {\n        return this.model.initialize();\n      } else if (this.model.attributes.message) {\n        return alertUser(this.model.attributes.message);\n      }\n    }), this);\n  };\n\n  CityView.prototype.template = function() {\n    var template;\n    template = require(\"./templates/city\");\n    return template(this.getRenderData());\n  };\n\n  CityView.prototype.deleteCity = function() {\n    var _this = this;\n    return this.model.destroy({\n      success: function() {\n        return _this.remove();\n      },\n      error: function() {\n        return alertUser(\"impossible to remove \" + _this.model.get(\"name\"));\n      }\n    });\n  };\n\n  return CityView;\n\n})(View);\n","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"row panel panel-warning\"><div class=\"row\"><div class=\"main col-xs-2\"><div><div class=\"label label-default\">Now</div></div><div><div title=\"temperature\" class=\"label label-info temp\">' + escape((interp = model.temp) == null ? '' : interp) + '°</div><div title=\"humidity\" class=\"label label-info humidity\">' + escape((interp = model.humidity) == null ? '' : interp) + '%</div></div>');\nif ( model.weather)\n{\nbuf.push('<div');\nbuf.push(attrs({ 'title':(\"\" + (model.weather.description) + \"\"), \"class\": ('weather') }, {\"title\":true}));\nbuf.push('><img');\nbuf.push(attrs({ 'alt':(\"\" + (model.weather.main) + \"\"), 'src':(\"icons/\" + (model.weather.icon) + \".png\") }, {\"alt\":true,\"src\":true}));\nbuf.push('/></div>');\n}\nbuf.push('<div><span title=\"remove\" class=\"remove\">&times;</span><div');\nbuf.push(attrs({ 'title':(\"\" + (model.country) + \"\"), \"class\": ('name') + ' ' + ('label') + ' ' + ('label-warning') }, {\"title\":true}));\nbuf.push('>' + escape((interp = model.name) == null ? '' : interp) + '</div></div></div>');\nif ( model.hours)\n{\n// iterate model.hours\n;(function(){\n  if ('number' == typeof model.hours.length) {\n\n    for (var $index = 0, $$l = model.hours.length; $index < $$l; $index++) {\n      var hour = model.hours[$index];\n\nbuf.push('<div class=\"hour col-xs-2\"><div><div class=\"label label-default\">' + escape((interp = hour.hour) == null ? '' : interp) + '</div></div><div><div class=\"label label-info temp\"><span title=\"temperature\">' + escape((interp = hour.temp) == null ? '' : interp) + '°</span></div>');\nif ( hour.humidity)\n{\nbuf.push('<div title=\"humidity\" class=\"label label-info humidity\">' + escape((interp = hour.humidity) == null ? '' : interp) + '%</div>');\n}\nbuf.push('</div>');\nif ( hour.weather)\n{\nbuf.push('<div');\nbuf.push(attrs({ 'title':(\"\" + (hour.weather.description) + \"\"), \"class\": ('weather') }, {\"title\":true}));\nbuf.push('><img');\nbuf.push(attrs({ 'alt':(\"\" + (hour.weather.main) + \"\"), 'src':(\"icons/\" + (hour.weather.icon) + \".png\") }, {\"alt\":true,\"src\":true}));\nbuf.push('/></div>');\n}\nbuf.push('</div>');\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in model.hours) {\n      $$l++;      var hour = model.hours[$index];\n\nbuf.push('<div class=\"hour col-xs-2\"><div><div class=\"label label-default\">' + escape((interp = hour.hour) == null ? '' : interp) + '</div></div><div><div class=\"label label-info temp\"><span title=\"temperature\">' + escape((interp = hour.temp) == null ? '' : interp) + '°</span></div>');\nif ( hour.humidity)\n{\nbuf.push('<div title=\"humidity\" class=\"label label-info humidity\">' + escape((interp = hour.humidity) == null ? '' : interp) + '%</div>');\n}\nbuf.push('</div>');\nif ( hour.weather)\n{\nbuf.push('<div');\nbuf.push(attrs({ 'title':(\"\" + (hour.weather.description) + \"\"), \"class\": ('weather') }, {\"title\":true}));\nbuf.push('><img');\nbuf.push(attrs({ 'alt':(\"\" + (hour.weather.main) + \"\"), 'src':(\"icons/\" + (hour.weather.icon) + \".png\") }, {\"alt\":true,\"src\":true}));\nbuf.push('/></div>');\n}\nbuf.push('</div>');\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push('</div>');\nif ( model.days)\n{\nbuf.push('<div class=\"row days\"><div class=\"day col-xs-2\"></div>');\n// iterate model.days\n;(function(){\n  if ('number' == typeof model.days.length) {\n\n    for (var $index = 0, $$l = model.days.length; $index < $$l; $index++) {\n      var day = model.days[$index];\n\nbuf.push('<div class=\"day col-xs-2\"><div><div class=\"label label-default\">' + escape((interp = day.date) == null ? '' : interp) + '</div></div><div><div class=\"label label-info temp\"><span title=\"temperature in night\">' + escape((interp = day.night) == null ? '' : interp) + '° / </span><span title=\"temperature in day\">' + escape((interp = day.day) == null ? '' : interp) + '°</span></div>');\nif ( day.humidity)\n{\nbuf.push('<div title=\"humidity\" class=\"label label-info humidity\">' + escape((interp = day.humidity) == null ? '' : interp) + '%</div>');\n}\nbuf.push('</div>');\nif ( day.weather)\n{\nbuf.push('<div');\nbuf.push(attrs({ 'title':(\"\" + (day.weather.description) + \"\"), \"class\": ('weather') }, {\"title\":true}));\nbuf.push('><img');\nbuf.push(attrs({ 'alt':(\"\" + (day.weather.main) + \"\"), 'src':(\"icons/\" + (day.weather.icon) + \".png\") }, {\"alt\":true,\"src\":true}));\nbuf.push('/></div>');\n}\nbuf.push('</div>');\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in model.days) {\n      $$l++;      var day = model.days[$index];\n\nbuf.push('<div class=\"day col-xs-2\"><div><div class=\"label label-default\">' + escape((interp = day.date) == null ? '' : interp) + '</div></div><div><div class=\"label label-info temp\"><span title=\"temperature in night\">' + escape((interp = day.night) == null ? '' : interp) + '° / </span><span title=\"temperature in day\">' + escape((interp = day.day) == null ? '' : interp) + '°</span></div>');\nif ( day.humidity)\n{\nbuf.push('<div title=\"humidity\" class=\"label label-info humidity\">' + escape((interp = day.humidity) == null ? '' : interp) + '%</div>');\n}\nbuf.push('</div>');\nif ( day.weather)\n{\nbuf.push('<div');\nbuf.push(attrs({ 'title':(\"\" + (day.weather.description) + \"\"), \"class\": ('weather') }, {\"title\":true}));\nbuf.push('><img');\nbuf.push(attrs({ 'alt':(\"\" + (day.weather.main) + \"\"), 'src':(\"icons/\" + (day.weather.icon) + \".png\") }, {\"alt\":true,\"src\":true}));\nbuf.push('/></div>');\n}\nbuf.push('</div>');\n    }\n\n  }\n}).call(this);\n\nbuf.push('</div>');\n}\nbuf.push('</div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div id=\"content\" class=\"container\"><h2>Weather forecast for Cozy</h2><div class=\"row\"><form id=\"search\" role=\"form\" class=\"col-xs-8 well\"><input name=\"city\" id=\"city-name\" placeholder=\"Type the name of a city and press enter (or name,country code to ensure country. For ex. paris,fr)\" title=\"Type the name of a city and press enter (or name,country code to ensure country. For ex. paris,fr)\" type=\"text\" class=\"form-control city\"/></form></div><div class=\"alerts\"></div><ul id=\"cities\" class=\"list-unstyled\"></ul></div><div id=\"footer\" class=\"container\"><small class=\"well well-small pull-right\"><p><a href=\"http://openweathermap.org/\">weather data from OpenWeatherMap</a></p><p><a href=\"http://d3stroy.deviantart.com/art/SILq-Weather-Icons-356609017\">icons from ~d3stroy</a></p></small></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div id=\"content\" class=\"container\"><ul id=\"cities\" class=\"list-unstyled\"></ul></div>');\n}\nreturn buf.join(\"\");\n};","var AppRouter, AppView, CitiesView, City, View,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nView = require(\"../lib/view\");\n\nAppRouter = require(\"../routers/app_router\");\n\nCitiesView = require(\"./cities_view\");\n\nCity = require(\"../models/city\");\n\nmodule.exports = AppView = (function(_super) {\n\n  __extends(AppView, _super);\n\n  function AppView() {\n    return AppView.__super__.constructor.apply(this, arguments);\n  }\n\n  AppView.prototype.el = \"body.widget\";\n\n  AppView.prototype.template = function() {\n    return require(\"./templates/widget\");\n  };\n\n  AppView.prototype.initialize = function() {\n    return this.router = PiourCozyOWM.Routers.AppRouter = new AppRouter();\n  };\n\n  AppView.prototype.afterRender = function() {\n    var _this = this;\n    this.citiesView = new CitiesView();\n    return this.citiesView.collection.fetch({\n      error: function() {\n        return alertUser(\"impossible to retrieve weather informations\");\n      }\n    });\n  };\n\n  AppView.prototype.events = {\n    \"click\": function() {\n      var intent;\n      intent = {\n        action: 'goto',\n        params: \"piour-owm/\"\n      };\n      return window.parent.postMessage(intent, window.location.origin);\n    }\n  };\n\n  return AppView;\n\n})(View);\n"]}